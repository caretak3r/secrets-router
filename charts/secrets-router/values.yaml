# Secrets Router Service Configuration

# Image configuration
image:
  repository: secrets-router
  tag: latest
  pullPolicy: Always

# Service configuration
service:
  type: ClusterIP
  port: 8080
  targetPort: 8080

# Deployment configuration
deployment:
  replicas: 2
  # Note: restartPolicy for Deployments is always 'Always' - included for completeness
  restartPolicy: Always
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

# Dapr configuration
dapr:
  enabled: true
  appId: secrets-router
  appPort: 8080
  config: ""
  logLevel: info
  enableApiLogging: false
  metrics:
    enabled: false
  tracing:
    enabled: false

# Environment variables
env:
  DEBUG_MODE: "false"
  LOG_LEVEL: "INFO"
  DAPR_HTTP_PORT: "3500"
  SERVER_PORT: "8080"
  # Service version
  SERVICE_VERSION: "1.0.2"

# ServiceAccount configuration
serviceAccount:
  create: true
  name: secrets-router
  annotations: {}
    # For AWS IRSA (if needed):
    # eks.amazonaws.com/role-arn: arn:aws:iam::ACCOUNT:role/secrets-router-role

# RBAC configuration
rbac:
  create: true

# Pod security
podSecurity:
  runAsNonRoot: true
  runAsUser: 65532
  fsGroup: 65532
  seccompProfile:
    type: RuntimeDefault

# Health checks
healthChecks:
  liveness:
    enabled: true
    path: /healthz
    port: 8080
    initialDelaySeconds: 30
    periodSeconds: 15
    timeoutSeconds: 3
    failureThreshold: 3
  readiness:
    enabled: true
    path: /readyz
    port: 8080
    initialDelaySeconds: 30
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 6
  startupProbe:
    enabled: true
    path: /healthz
    port: 8080
    initialDelaySeconds: 30
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 12

# Network policies
networkPolicy:
  enabled: false

# Ingress (optional)
ingress:
  enabled: false

# Secret Stores Configuration
# Kubernetes Secrets are enabled by default
secretStores:
  # Configuration for AWS Secrets Manager
  aws:
    enabled: false
    region: us-east-1 # this will be the top-level region for the AWS helper function
    # Optional: Enable multiple key-value pairs per secret (defaults to false)
    multipleKeyValuesPerSecret: false
