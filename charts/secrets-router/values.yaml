# Secrets Router Service Configuration

# Image configuration
image:
  repository: secrets-router
  tag: latest
  pullPolicy: Always

# Service configuration
service:
  type: ClusterIP
  port: 8080
  targetPort: 8080

# Deployment configuration
deployment:
  replicas: 1
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

# Dapr configuration
dapr:
  enabled: true
  appId: secrets-router
  appPort: 8080
  config: ""
  logLevel: info
  enableApiLogging: false
  metrics:
    enabled: false
  tracing:
    enabled: false

# Environment variables
env:
  DEBUG_MODE: "false"
  LOG_LEVEL: "INFO"
  DAPR_HTTP_PORT: "3500"
  SERVER_PORT: "8080"
  # Service version
  SERVICE_VERSION: "0.0.1"
  
  # AWS Secrets Manager secret paths (optional)
  # Configure full paths for AWS secrets in this section
  # Example:
  # AWS_SECRET_PATHS:
  #   database-credentials: "/app/secrets/production/database-credentials"
  #   api-key: "/app/secrets/production/api-key"

# ServiceAccount configuration
serviceAccount:
  create: true
  name: secrets-router
  annotations: {}
    # For AWS IRSA (if needed):
    # eks.amazonaws.com/role-arn: arn:aws:iam::ACCOUNT:role/secrets-router-role

# RBAC configuration
rbac:
  create: true

# Pod security
podSecurity:
  runAsNonRoot: true
  runAsUser: 65532
  fsGroup: 65532
  seccompProfile:
    type: RuntimeDefault

# Health checks
healthChecks:
  liveness:
    enabled: true
    path: /healthz
    port: 8080
    initialDelaySeconds: 30
    periodSeconds: 10
  readiness:
    enabled: true
    path: /readyz
    port: 8080
    initialDelaySeconds: 10
    periodSeconds: 5

# Network policies
networkPolicy:
  enabled: false

# Ingress (optional)
ingress:
  enabled: false

# Secret Stores Configuration
secretStores:
  # Configuration for AWS Secrets Manager
  aws:
    enabled: true
    region: us-east-1 # this will be the top-level region for the AWS helper function
    # Optional: Path prefix for all AWS secrets
    pathPrefix: ""
    auth:
      secretStore: kubernetes
      # Optional: Additional auth metadata
      metadata: {}
      #   accessKey: "AWS_ACCESS_KEY_ID"
      #   secretKey: "AWS_SECRET_ACCESS_KEY"
